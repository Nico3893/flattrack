<% content_for(:title) do %>
  Flattrack <%= @flat.address %>
<% end %>

<%= render 'shared/taskModal' %>

<div class="container">
  <h2 class="header"><%= @flat.address %></h2>
  <div class="kpi-container">
    <div class="kpi-container-item-a">
      <i class="fas fa-money-bill-wave" style="font-size:2em"></i>
      <h2 class="cashflow" style="font-weight:bolder"><%= @cashflow %>€</h2>
    </div>
    <div class="kpi-container-item-b">
      <img src="/icon_transaction _category_utilities.png" style="width:32px;height:32px" alt="" />
      <h2 class="utilities" style="font-weight:bolder"><%= @utilities %>€</h2>
    </div>
    <div class="kpi-container-item-c">
      <span class="icon-stack"><i class="fas fa-ruler-combined icon-stack-3x" style="width:24px;height:24px"></i>
      <i class="fas fa-euro-sign icon-stack-1x"></i></span>
      <h2 style="font-weight:bolder;margin-top:0;position:relative;bottom:1em;"><%= @flat.monthly_rent / @flat.area %>€/m²</h2>
    </div>
    <div class="kpi-container-item-d">
      <i class="fas fa-ruler-combined" style="font-size:1.5rem"></i>
      <h2 style="font-weight:bolder"><%= @flat.area %>m² </h2>
    </div>
  </div>
  <!-- end of kpi-container-->
  <!-- start of flat-info-->
  <div class="flat-info-container">
  <!-- left-side-container in flat-info -->
    <div class="flat-info-column-a">
      <div class="flat-info-foto-display">
        <%= render 'shared/flatCarousel' %>
      </div>
      <div class="flat-info-important">
        <div class="task-card-small-a">
          <h3>Special comments</h3>
          <p><%= @flat.comment %></p>
        </div>
      </div>
    </div>
    <!-- right-side-container in flat-info-->
    <div class="flat-info-column-b">
      <!--<div class="flat-info-column-b-item-a">-->
        <!-- Button trigger modal -->
      <div style="justify-self: center; align-self: end">
        <button type="button" class="button-dark" data-toggle="modal" data-target="#exampleModalCenter">
        NEW TASK
        </button>
      </div>
        <% @tasks.each do |task| %>
          <div class="task-card-flat-show">
            <div class="row" style="display:flex; flex-direction:row;justify-content:space-around">
            <h3>
              <%if task.category.name.downcase =="repair"%> 
                <img style ="height:20px;width:20px;" src="/icon_task_category_repair.png" />  
              <% elsif task.category.name.downcase =="maintenance"%>
                <img style ="height:20px;width:20px;" src="/icon_task_category_maintenance.png" />  
              <% elsif task.category.name.downcase =="restocking"%>
                <img style ="height:20px;width:20px;" src="/icon_task_category_restocking.png" />   
              <% elsif task.category.name.downcase =="furnishing"%>
                <img style ="height:20px;width:20px;" src="/icon_task_category_furnishing.png" />   
              <%else%>
                <img style ="height:20px;width:20px;" src="/icon_task_category_general.png" />  
              <%end%>
                <%= task.title %>
              </h3>
              <div>
                <%= cl_image_tag task.user.photo, crop: :thumb, class: "avatar" %>
              </div>          
            </div>
            <p class="content"><%= task.description %></p>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
