<% content_for(:title) do %>
  Flattrack <%= @flat.address %>
<% end %>

<%= render 'shared/taskModal' %>

<div class="container">
  <h2 class="header"> 
  
    <%= @flat.address %>
  </h2>
  <div class="kpi-container">
    <div class="kpi-container-item-a">
      <h2 class="cashflow" style="font-weight:bolder"><%= @cashflow %>€</h2>
      <h2 class="subheader">CASHFLOW</h2>
      </div>
    <div class="kpi-container-item-b">
      <h2 class="utilities" style="font-weight:bolder"><%= @utilities %>€</h2>
      <h2 class="subheader">UTILITIES</h2>
    </div>
    <div class="kpi-container-item-c">
      <h2 style="font-weight:bolder"><%= @flat.monthly_rent / @flat.area %>€</h2>
      <h2 class="subheader">RENT / m²</h2>
    </div>
    <div class="kpi-container-item-d">
      <h2 style="font-weight:bolder"><%= @flat.area %>m² </h2>
      <h2 class="subheader">AREA</h2>
    </div>
  </div>
  <!-- end of kpi-container-->
  <!-- start of flat-info-->
  <div class="flat-info-container">
  <!-- left-side-container in flat-info -->
    <div class="flat-info-column-a">
      <div class="flat-info-foto-display">
        <%= render 'shared/flatCarousel' %>
      </div>
      <div class="flat-info-important">
        <div class="task-card-small-a">
          <h3 class="lighter grey-out">Special comments</h3>
          <p><%= @flat.comment %></p>
        </div>
      </div>
    </div>
    <!-- right-side-container in flat-info-->
    <div class="flat-info-column-b">
      <!--<div class="flat-info-column-b-item-a">-->
        <!-- Button trigger modal -->
      <div style="display:grid">
                <h3 class="lighter grey-out"style="align-self:end; justify-self: start">URGENT</h3>

        <button style="justify-self: center; align-self: end" type="button" class="button-dark" data-toggle="modal" data-target="#exampleModalCenter">
        NEW TASK
        </button>
      </div>

 
  <!--<%if @tasks.count==0%> 
  <%elsif @tasks.count==1%>
    <span>
    <%=@tasks.count%> Pending Task</span> 
  <%else%> 
    <span style="color:red;font-weight:bolder"><%=@tasks.count%>&nbsp;<i class="fas fa-tasks">  
    </i>
    </span>  
  <%end%>-->
  

        <% @tasks.each do |task| %>
          <div class="task-card-flat-show">
            <div class="row" style="display:flex; flex-direction:row;justify-content:space-around">
            <div class="card-head">
            <h3>
              <%if task.category.name.downcase =="repair"%> 
                <img style ="height:20px;width:20px;" src="/icon_task_category_repair.png" />  
              <% elsif task.category.name.downcase =="maintenance"%>
                <img style ="height:20px;width:20px;" src="/icon_task_category_maintenance.png" />  
              <% elsif task.category.name.downcase =="restocking"%>
                <img style ="height:20px;width:20px;" src="/icon_task_category_restocking.png" />   
              <% elsif task.category.name.downcase =="furnishing"%>
                <img style ="height:20px;width:20px;" src="/icon_task_category_furnishing.png" />   
              <%else%>
                <img style ="height:20px;width:20px;" src="/icon_task_category_general.png" />  
              <%end%>
                <%= task.title %>
              
              </h3>
              </div>
              <div>
                <%= cl_image_tag task.user.photo, crop: :thumb, class: "avatar" %>
              </div>          
            </div>
            <p class="content"> <%if task.urgency == 3%>
                 <i class="fas fa-exclamation-triangle" style="color:red"></i>
                <%elsif task.urgency == 2%>
          <i class="fas fa-arrow-up" style="color:#FFC65A"></i>
                <%else%>
                   <i class="fas fa-arrow-down" style="color:green"></i>
                <%end%><%= task.description %>
             </p>
          </div>
        <% end %>
        
      </div>
    </div>
  </div>
</div>
